<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Obsydian AI</title>
    <link rel="stylesheet" type="text/css" href="taskpane.css" />
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>
  </head>
  <body>
    <div id="app">
      <!-- LANDING VIEW -->
      <div id="landingView">
        <div class="landing-content">
          <div class="landing-logo-container">
            <img src="assets/logo-mail.png" alt="Obsydian AI" class="landing-logo" />
          </div>
          <h1>Log the claim directly with Obsydian AI</h1>
          <button id="createClaimBtn" class="primary-btn">Create a claim</button>
        </div>
      </div>

      <!-- FORM VIEW -->
      <div id="formView" class="hidden">
        <div class="form-header">
          <div class="header-top">
            <div class="logo-container">
              <img src="assets/logo-mail.png" alt="Obsydian AI" class="header-logo" />
              <span class="brand-name">Obsydian AI</span>
            </div>
            <div class="back-btn-container">
              <button id="backToLandingBtn" class="back-btn">‚Üê Back</button>
            </div>
          </div>
          <h2>Submit a claim</h2>
        </div>

        <form id="claimForm">
          <!-- Step 1: Carrier Selection -->
          <div class="form-step" id="step1">
            <div class="form-group">
              <label for="carrierSelect">Select Courier Account</label>
              <select id="carrierSelect" name="carrier" required>
                <option value="">Choose a carrier...</option>
                <option value="ups_001">UPS</option>
              </select>
            </div>
          </div>

          <!-- Step 2: UPS Form Fields (shown after carrier selection) -->
          <div class="form-step hidden" id="upsFields">
            <div class="form-group">
              <label for="trackingNumber">Tracking No.*</label>
              <input type="text" id="trackingNumber" name="trackingNumber" required placeholder="Enter tracking number">
            </div>

            <div class="form-group">
              <label for="incidenceType">Incidence Type*</label>
              <select id="incidenceType" name="incidenceType" required>
                <option value="">Select incidence type...</option>
                <option value="DAMAGED">Package Damaged</option>
                <option value="LOST">Package Lost</option>
              </select>
            </div>

            <div class="form-group hidden" id="supportingEvidenceGroup">
              <label for="supportingEvidence">Please upload supporting evidence</label>
              <div class="file-upload-container">
                <input type="file" id="supportingEvidence" name="supportingEvidence" accept=".pdf,.jpg,.jpeg,.png" class="file-input">
                <label for="supportingEvidence" class="file-upload-btn">
                  <svg class="upload-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6b7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                    <path d="M21.44 11.05l-9.19 9.19a6 6 0 01-8.49-8.49l9.19-9.19a4 4 0 115.66 5.66L9.88 17.94a2 2 0 11-2.83-2.83l8.48-8.48"/>
                  </svg>
                  <span class="upload-text">Click to upload</span>
                </label>
                <div class="file-name" id="supportingEvidenceName"></div>
              </div>
            </div>

            <div class="form-group">
              <label for="description">Incident Description*</label>
              <textarea id="description" name="description" required placeholder="Describe the incident in detail"></textarea>
            </div>

            <div class="form-group">
              <label for="customerAddress">Customer address*</label>
              <textarea id="customerAddress" name="customerAddress" required placeholder="Enter customer address"></textarea>
            </div>

            <div class="form-group">
              <label for="destinataryPhoneNumber">Destinatary phone number*</label>
              <input
                type="tel"
                id="destinataryPhoneNumber"
                name="destinataryPhoneNumber"
                required
                placeholder="Enter destinatary phone number">
            </div>

            
            <div class="form-group">
              <div class="shipment-header">
                <div class="shipment-title">Payment Proof</div>
                <div class="shipment-subtitle">Upload invoice or payment receipt</div>
              </div>
              <div class="file-upload-container">
                <input type="file" id="proofOfPurchase" name="proofOfPurchase" accept=".pdf,.jpg,.jpeg,.png" required class="file-input">
                <label for="proofOfPurchase" class="file-upload-btn">
                  <svg class="upload-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6b7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                    <path d="M21.44 11.05l-9.19 9.19a6 6 0 01-8.49-8.49l9.19-9.19a4 4 0 115.66 5.66L9.88 17.94a2 2 0 11-2.83-2.83l8.48-8.48"/>
                  </svg>
                  <span class="upload-text">Click to upload</span>
                </label>
                <div class="file-name" id="proofOfPurchaseName"></div>
              </div>
            </div>

            <div class="form-group">
              <div class="shipment-header">
                <div class="shipment-title">Shipment Items</div>
                <div class="shipment-subtitle">Add items included in this shipment</div>
              </div>
              <!-- Hidden field used for API payload composed from items -->
              <input type="hidden" id="contentsDescription" name="contentsDescription">
              <div class="items-list" id="itemsList"></div>
              <button type="button" id="addItemBtn" class="add-item-btn">
                <span class="add-icon" aria-hidden="true">+</span>
                <span>Add Item</span>
              </button>
            </div>

            

            <div class="form-actions">
              <button type="button" id="cancelBtn" class="secondary-btn">Cancel</button>
              <button type="submit" id="submitBtn" class="primary-btn">Submit</button>
            </div>
          </div>
        </form>
      </div>

      <!-- SUCCESS VIEW -->
      <div id="successView" class="hidden">
        <div class="success-container">
          <div class="success-logo-container">
            <img src="assets/logo-mail.png" alt="Obsydian AI" class="success-logo" />
          </div>
          <h1 class="success-title">Claim Submitted</h1>
          <div class="success-claim-id">Claim ID: <span id="successClaimId">-</span></div>

          <div class="success-details-section">
            <h3 class="success-details-title">Claim Details</h3>
            <div class="success-details-grid">
              <div class="success-detail-item">
                <span class="success-detail-label">Tracking No.:</span>
                <span class="success-detail-value" id="successTracking">-</span>
              </div>
              <div class="success-detail-item">
                <span class="success-detail-label">Created on:</span>
                <span class="success-detail-value" id="successCreatedOn">-</span>
              </div>
              <div class="success-detail-item">
                <span class="success-detail-label">Status:</span>
                <span class="success-detail-value" id="successStatus">Created</span>
              </div>
            </div>
          </div>

          <div class="success-message-box">
            Claim opened in Obsydian using your Outlook integration
          </div>

          <div class="success-buttons">
            <button id="viewDetailsBtn" class="success-btn-primary">View details page</button>
            <button id="newClaimBtn" class="success-btn-secondary">Create new claim</button>
          </div>
        </div>
      </div>

      <!-- LOADING VIEW -->
      <div id="loadingView" class="hidden">
        <div class="loading-content">
          <div class="spinner"></div>
          <p id="loadingText">AI is analyzing email content...</p>
        </div>
      </div>
    </div>

    <script type="text/javascript" src="taskpane.js"></script>
  </body>
</html>

